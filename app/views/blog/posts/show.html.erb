<% content_for :title, @post.title %>
<% content_for :meta_description, @post.meta_description || @post.excerpt %>
<% content_for :og_type, 'article' %>
<% content_for :og_title, @post.title %>
<% if @post.og_image.present? %>
  <% content_for :og_image, @post.og_image %>
<% end %>

<% content_for :structured_data do %>
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      "headline": "<%= j @post.title %>",
      "datePublished": "<%= @post.published_at.iso8601 %>",
      "dateModified": "<%= @post.published_at.iso8601 %>",
      "author": {
        "@type": "Person",
        "name": "<%= j @post.author_model&.name || 'Billy Heaton' %>"
      },
      "publisher": {
        "@type": "Organization",
        "name": "pixelhandler.dev",
        "logo": {
          "@type": "ImageObject",
          "url": "<%= root_url %>icon.png"
        }
      },
      "description": "<%= j(@post.meta_description || @post.excerpt) %>",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "<%= post_url(@post) %>"
      }
    }
  </script>
<% end %>

<%= render Blog::LayoutComponent.new do |c| %>
  <% c.with_sidebar do %>
    <%= render Blog::SidebarComponent.new(tags: @tags, show_search: true, show_about: false) %>

    <% if @related_posts.any? %>
      <div class="card">
        <h3 class="text-lg font-semibold text-[var(--text-primary)] mb-4">
          <%= t('blog.posts.related') %>
        </h3>
        <ul class="space-y-3">
          <% @related_posts.each do |post| %>
            <li>
              <a href="<%= post_path(post) %>" class="text-[var(--link-color)] hover:text-[var(--link-hover)] text-sm">
                <%= post.title %>
              </a>
            </li>
          <% end %>
        </ul>
      </div>
    <% end %>
  <% end %>

  <%= render Blog::PostShowComponent.new(post: @post) %>
<% end %>
